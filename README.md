# Домашнее задание к занятию «Введение в микросервисы» - Илларионов Дмитрий

## Задача

Руководство крупного интернет-магазина, у которого постоянно растёт пользовательская база и количество заказов, рассматривает возможность переделки своей внутренней   ИТ-системы на основе микросервисов. 

Вас пригласили в качестве консультанта для оценки целесообразности перехода на микросервисную архитектуру. 

Опишите, какие выгоды может получить компания от перехода на микросервисную архитектуру и какие проблемы нужно решить в первую очередь.


# Решение

## Выгоды

Раз крупный интернет магазин, значит большой объем товаров, большой товаро-оборот, много сотрудников, большая организация, множество сервисов. Если делать все в монолите, сложно поддерживать и долго выпускать новые версии. 
Видится рациональным - разнести на микросервисы (с умом не переусердсвуя).
Требования:
- разделить функционал на отедльные микросервисы, изменение которых можно проводить без изменения остальных
- тогда можно весь функционал разделить на разные команды разработки. У команды разработки будет один или несколько поддерживаемых микросервисов. Станет проще и быстрее разрабатывать, и внедрять.
- повысится качество проработки кода, если одна команда будет сосредоточена на меньшем объеме функционала. Выше скорость исправления багов, выпуска новых фич.
- каждая команда будет взаимодействовать в основном внутри себя, это выше производительность. Меньше взаимодействия между разными командами.
- если предодолеть стартовые расходы на автоматизацию развертывания, то, потом будет это просто и быстро.
- для разных задач можно разные технологии применять - стек разработки.


Выгоды:

В распределенной системе снижается зависимость между компонентами.
Возможность оперативно наращивать мощности, за счет горизонтального масштабирования и обратно сокращать объем системы при снижении нагрузки.
Снижать риски деградации системы и полного отказа за счет отсутствия единой точки отказа, повышенная работоспособность.
Возможность использования различных стеков и технологий, в зависимости от архитектуры и потребности конкретного микросервиса, а не всей системы в целом (различные типы БД в разных микросервисах, разные языки программирования и т.п.).
Возможность гибко добавлять сложный функционал за счет разработки новых сервисов.
Повышение возможности делать более частые релизы, т.е. быстрее выводить новые функции и фичи и ускорение тестирование - тестирование отдельных сервисов, а не монолитной системы с регресстестированием при модификации какой-либо части.
За счет повторения сервисами структуры коммуникации организации, можно создать более гармоничную систему при разделении команд на разных сервисах с разными задачами и бизнес целями.
Повышение отказоустойчивости и скорости восстановления. В случае проблем в одном из модуля (микросервиса), будет недоступен функционал этого модуля, а не система целиком.
Балансировка нагрузки, возможность репликации наиболее нагруженных компонентов на несколько нод системы (при необходимости между несколькими географически распределенными площадками)


## минусы или накладные расходы

Нужно буедт четко определить взаимодействие между сервисами. Это может стать дополнительнйо разработкой концепции, составление ТЗ, регламентов. Это должно быть изучено и согласовано всеми командами - чтобы было ясно как они будут взаимодействовать.
Может появитсья большое количество сервисов. Если раньше был монолит, то, его вчем-то проще было деплоить - один раз за длительный срок. Например раз в пол  года выпуск новой версии. Такой деплой можно было делать и вручную.
Но, если появлюятся микросервисы, то, их много и есть частый деплой, то, если это делать продолжать вручную - высокая трудоемкость и высокие риски ошибиться. Поэтому нужно делать автоматизацию выклдаки новых версий.
Для этого:
- возможно придется изучать технологии, типа, докер, кубернетис, ансибл, ci-cd пайпланы в gitlab-ci. 
- потребуются дополнительные специалисты
- потребуется время на разработку автоматизации - написания кода, отлова ошибок.
- если это новая деятельность, в первое время будет долго и сложно, будет казаться что идем по  не верному пути, т.к. все усложнилось, а лучше бы попроще как было раньше. Особенно, если нужно скорее выпустить новый релиз, то, есть риск получить как на картинке:

![alt text](image.png)

Важно обеспечить малую связанность микросервисов - чтобы их можно было разрабатыватьи обновлять  независимо от других.

Нужно наладить тестирование всех микросервисов. Это доп расходы, т.к. может быть ранее нужно было только вручную протестировать большой монолит - функциональное тестирование, что все работает.
Появляются вопросы - сколько делать копий микросервисов, делать еще и балансировку.
При этом возможно придется делать очереди (брокеры очередей) типа rabbit-mq для распределенеие событий по микросервисам разным, и для организации их взаимодействия. Это усложнение структуры системы, доп разработка.
Нужно уже четко понимать бизнес процессы. Но, т.к. магазин уже давно, то, это не проблема. Но, нужно возможно расписать эти бизнес процессы и разделить их на сервисы.
Можно будет легко потом масштабировать систему, например, добавлять копии микросервисов динамически в моменты пиковой нагрузки. 
Потребуется делать сложные системы мониторинга, и сбора и анализа логов.
Есть риск ошибиться и создать большое количество наносервисов, что только все усложнит. Т.е. нужно с умом разделять на микросервисы - найти оптимум. Слишком много зависимых друг от друга микросервисов - плохо.
Определить кто владеет микросервисом, и как его обновлять, могут ли обновлять другие разработчики. 
Нужен общий git репозиторий.
Что бы минимизировать "зоопарк" и разные технологии, возможно придется ввести регламенты в компании для ограничения технологий.
Возможно придется думать дополнительно о безопасности, как делать аутентификацию SSO Single Sign On и др.


Проблемы:

На первом этапе потребуется проработать вопросы целевой архитектуры продукта, выделение микросервисов. Выбрать стек инфраструктуры, создать инфраструктуру. Сформировать команды и определить стек каждого микросервиса.
Микросервисы не являются решением всех проблем. Решать проблемы вычислительных мощностей и инфраструктуры так же придется.
Необходимо найти баланс и не дробить систему слишком сильно. Можно чрезмерно усложнить систему большим количеством мелких сервисов.
Изменение оргструктуры организации, разделение на команды и изменение состава команд.
Так же необходимо повышать квалификацию инженеров и разработчиков, их функциональных обязанностей (документирование, версионирование). Вероятно придется расширить штат разработчиков в связи с распределением систем и разделением команд для разных сервисов.
Возможно введение дополнительной службы (возможно внтурикомандного распределение обязанностей) - DevOps



